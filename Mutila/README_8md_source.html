<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mutila: Mouse&#39;s Utilities for Arduino: README.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mutila: Mouse&#39;s Utilities for Arduino
   </div>
   <div id="projectbrief">Oft-used utilities: debouncing buttons, averaging samples, and so on.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">README.md</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;# Mouse&#39;s Utilities for Arduino (Mutila)</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Re-usable utility components for Arduino projects. All the stuff we all end up re-implementing every project - buttons, averaging samplers, voltage and current measurements calculations and so on. The classes and functions in this library are intended to be flexible, efficient and stable, as well as following a style which is broadly similar to the core Arduino libraries.</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;## Author &amp; License</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;All code written by Matthew Gates (Mouse), and licensed under the GNU GPL version 3. See the LICENSE file for details.</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;## Feature Summary</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;### Inputs</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;A collection of classes and functions for nice handling of basic inputs (buttons and such). The classes are kept as simple as possible while having enough functionality to be useful. &#39;&#39;Time slice-based&#39;&#39; classes should have their &#39;&#39;update()&#39;&#39; method called as frequently as possible, which will return rapidly. These classes are an alternative to interrupt driven IO for projects where interrupts can&#39;t be used - e.g. where *Mutila* inputs must not interfere with timing of other parts of your project which might use interrupts themselves (e.g. motor control)</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;* *DigitalInputButton* - switch from a digital input pin.</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;* *AnalogInputButton* - switch from an analog input pin.</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;* *DualInputButton* - switch from combination of two other buttons.</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;* *DebouncedButton* - time slice-based debounced button class with input from a DigitalInputButton object.</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;* *DebouncedAnalogButton* - time slice-based debounced button class with input from an AnalogInputButton object.</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;* *DebouncedDualButton* - time slice-based debounced button class with input from a DualInputButton object.</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;* *DiscretePot* - use a potential divider attached to an analog input to return a discrete value within a specified range - includes smoothing.</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;* *QuantizedPot* - use a potential divider attached to an analog input to return a discrete value based on specific ranges of raw values - includes smoothing.</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;* *ToggleButton* - each press flips state from on to off.</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;Terms used for Mutila input classes:</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;* *on*: instantaneous logical value.</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;* *pushed*: button is on now, and this is the first time pushed has been tested since the button became on.</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;* *tapped*: button has been pushed and released.</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;* *held*: is on and has been for more than some period of time (over and above debouncing).</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;* *repeat*: is held, but will only return true periodically - the delay between true returns is different (typically longer) for the first repeat, and then shorter for subsequent repeats. This follows common repeat characteristics of computer keyboards.</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;### Samplers</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;Samplers read from analog input pins and allow some operations to be performed on the data - typically calculating some sort of average value for the pin to help de-noise signals from sensors.</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;* *BufferedSampler* - keeps a buffer of recent samples, providing ability to get average, minimum and maximum for values in the buffer.</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;* *EMASampler* - provides calculation of exponential moving average value for an analog input.</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;Sampling voltage and current values may be performed using the following classes, which are good examples of how to derive custom samplers from BufferedSampler and EMASampler:</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;* *BufferedVDivSampler* - measure voltage over a voltage divider using BufferedSampler.</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;* *EMAVDivSampler* - measure voltage over a voltage divider using EMASampler.</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;* *EMACurrentSampler* - measure current using an Allegro ACS756SCB-050B-PFF-T Bi-directional 50A hall effect sensor and EMASampler.</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;### DFPlayer Mini MP3 audio module</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;DFPlayer Mini is a neat and affordable audio module which can play MP3 files from an SD card with a serial interface for control. It can also drive a small speaker. Mutila provides the class *DFPlayerMini* for controlling such a device. *DFPReader* is a class which can be used to read out numbers and durations, using the samples in the *audio/* directory.</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;### HC-SR04 Ultrasonic Ranger</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;HC-SR04 ultrasonic range finding modules are inexpensive and popular modules used in Arduino projects. While using them is simple (it only takes a few lines of code to fetch and calculate the range), Mutila provides the following classes for clean usage of these modules, and enhanced functionality:</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;* *SonicRanger* - a basic wrapper around the code necessary to calculate the range of an object, done in the same style as other Mutila classes (with pins passes in a constructor and initialized in a begin() member).</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;* *EMASonicRanger* - periodic sampling of the range value, smoothed using the exponential moving average method.</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;### Heartbeat</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;Mutila&#39;s *Heartbeat* class can be used to blink and LED with variable patterns to give some diagnostic information about the state of the program without needed a more sophisticated display.</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;### Mode System</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;A *Mode* is a kind of sub-program which has distinct startup, shutdown and update routines.  For example, your program might have a special setup mode which suspends normal operations while settings are altered. The *ModeManager* class can be used to switch between such mutually exclusive modes while keeping your main loop clean and simple. </div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;Modes may be arranged in a hierarchical manner using the *ParentMode* class. This can be useful when building hierarchical menu systems which a couple of buttons.</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;### EEPROM-backed Settings</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;*PersistentSetting* provides an EEPROM-backed store for settings which you want to survive Arduino resets.</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;## API Documentation</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;Doxygen-generated documentation can be found here: https://matthewg42.github.io/Mutila/</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;### Generating documentation</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;1.  Install Doxygen</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;2.  Run &#39;&#39;doxygen&#39;&#39; from the root of this project - html is generated in doc/html</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;## Ideas for future development</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;### Auto version message</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;It would be really nice to have some mechanism to write the current project version, and library versions into flash automatically.  By version I guess I mean git short hash of library version from library.properties.</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;### StickyButton</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;* When pushed, stays on for some period of time and then switches off.</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;* Pushing when on restarts the on timer.</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;### n-state button</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;* state=0 --&gt; state=1 ... --&gt; state=n-1 --&gt; state=0.</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;* This makes ToggleButton just an n-state where n=2.</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;### DFPlayerMini</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;* doc ops which create reply</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;* asynchronous commands (i.e. do not wait for serial, use update() to send bytes one at a time)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;## Development Workflow</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;At time of writing, Mutila is a one-Mouse project. versions up until v1.1.0 were not made into releases, and most work was done directly in master. However, enough projects now use Mutila that is makes sense to start being a bit more structured, so here&#39;s how it&#39;s going to work from now (until I need to change it again).</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;* After v1.1.1, the *master* branch is just for releases, which (I hope) will be well-tested and stable.</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;* Each release will be summarised in the ReleaseNotes.md file.</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;* Minor new features, bug fixes and the like will go in the *dev* branch, which will periodically be merged with master to create a new release.</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;* Major new features will be created in feature branches.</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
